PROGRAM ALUNO;
USES CRT;
TYPE AL = RECORD
     NOME : STRING[20];
     NUMERO : REAL;
     NOTA1 : REAL;
     NOTA2 : REAL;
     POSICAO,K : INTEGER;
END;

AL2 = FILE OF AL;

VAR AL3,AUXILIAR:AL2;
    AL4,AUX: AL;
    NOME : STRING[20];
    NUMERO : REAL;
    NOTA1 : REAL;
    NOTA2 : REAL;
    POSICAO,K,I : INTEGER;
    ACHOU: BOOLEAN;

BEGIN
CLRSCR;
WRITELN('PROGRAMA ALUNO');
ASSIGN(AL3,'G:\ALUNO.DAT');
REWRITE(AL3);
ASSIGN(AUXILIAR,'AUXILIAR.DAT');
REWRITE(AUXILIAR);
K:=FILESIZE(AL3);

WHILE (TRUE) DO
BEGIN
 CLRSCR;
 WRITELN ('AAAA - PARA SAIR DIGITE FIM MAIUSCULO');

 WRITELN('DIGITE O NOME ');
 READLN(NOME);

 IF (NOME = 'FIM') THEN BREAK;

 WRITELN('DIGITE O NUMERO ');
 READLN(NUMERO);
 WRITELN('DIGITE A NOTA1 ');
 READLN(NOTA1);
 WRITELN('DIGITE A NOTA2 ');
 READLN(NOTA2);

IF (K=0) THEN
BEGIN
AL4.NOME := NOME;
AL4.NUMERO:= NUMERO;
AL4.NOTA1:= NOTA1;
AL4.NOTA2:= NOTA2;
WRITE(AL3,AL4);
WRITELN('REGISTRADO!');
END
ELSE
BEGIN
I:=0;
ACHOU:=FALSE;
WHILE(I<=(K-1))DO
BEGIN
READ(AL3,AL4);
IF(AL4.NOME = NOME)
THEN BEGIN
ACHOU:=TRUE;
I:=K+1;
END
ELSE BEGIN
I:=I+1;
SEEK(AL3, I);
END;
END;
IF(ACHOU = TRUE) THEN
WRITELN('NOME JA CADASTRADO')
ELSE BEGIN
SEEK(AL3,K);
AL4.NOME:=NOME;
AL4.NUMERO:=NUMERO;
AL4.NOTA1:=NOTA1;
AL4.NOTA2:=NOTA2;
WRITE(AL3,AL4);
WRITELN('NOME INCLUIDO');
END;
CLOSE (AL3);
RESET(AL3);
WRITELN('NOME - NUMER - NOTA1 - NOTA2');
FOR I:=0 TO FILESIZE(AL3)-1 DO
BEGIN
SEEK(AL3, I);
READ(AL3, AL4);
WRITELN(AL4.NOME);
WRITELN(AL4.NUMERO);
WRITELN(AL4.NOTA1);
WRITELN(AL4.NOTA2);
END;
ACHOU:=FALSE;
READ(AL3,AL4);
WHILE(ACHOU = FALSE) AND (NOT EOF(AL3)) DO
BEGIN
IF (AL4.NOME = NOME)
THEN BEGIN
ACHOU:=TRUE;
POSICAO:=FILEPOS(AL3)-1;
END;
READ(AL3,AL4);
END;
IF (ACHOU = TRUE) THEN BEGIN
K:=0;
SEEK (AL3,K);
WHILE(K<POSICAO)DO
BEGIN
SEEK(AL3,K);
READ(AL3,AL4);
AUX.NOME:=AL4.NOME;
AUX.NOTA1:=AL4.NOTA1;
AUX.NOTA2:=AL4.NOTA2;
WRITE(AUXILIAR,AUX);
K:=K+1;
END;
K:=POSICAO +1;
WHILE(K<=FILESIZE(AL3)-1)DO
BEGIN
SEEK(AL3,K);
READ(AL3,AL4);
AUX.NOME:=AL4.NOME;
AUX.NOTA1:=AL4.NOTA1;
AUX.NOTA2:=AL4.NOTA2;
WRITE(AUXILIAR,AUX);
K:=K+1;
END;
REWRITE(AL3);
RESET(AUXILIAR);
WHILE(NOT EOF(AUXILIAR))DO
BEGIN
READ(AUXILIAR,AUX);
AL4.NOME:=AUX.NOME;
AL4.NOTA1:=AUX.NOTA1;
AL4.NOTA2:=AUX.NOTA2;
WRITE(AL3,AL4);
END;
WRITELN('CARRO EXCLUIDO');
END
ELSE WRITELN('CARRO NAO CADASTRADO');
CLOSE(AL3);
CLOSE(AUXILIAR);
READKEY;
END;
END;
CLOSE (AL3);

CLRSCR;
WRITELN ('RESULTADOS FINAIS');
WRITELN;
WRITELN ('NOME       NOTA1      NOTA2');

I:=0;

RESET (AL3);

WHILE NOT EOF (AL3) DO
BEGIN
   SEEK (AL3,I);
   READ (AL3, AL4);
   WRITELN (AL4.NOME, '     ', AL4.NOTA1:5:2, '    ', AL4.NOTA2:5:2, '     ');
   I:= I + 1;
END;

CLOSE (AL3);

READKEY;
END.